<?xml version="1.0"?>
<project name="OpenPetra-tobe-migrated">
<!-- All targets in this file should go away when the new buildfiles are ready -->

<include buildfile="OpenPetra.common.xml"/>

<target name="generateORM" depends="" description="Generates the cached tables">
  <loadtasks assembly="${Ict.Tools.NAntTasks.DLL}" unless="${task::exists('ExecDotNet')}"/> 
  <property name="CachedTableParameters" value="-petraxml:${PetraXML.file} -outputshared:${dir.root}/csharp/ICT/Petra/Shared -TemplateDir:${dir.root}/csharp/ICT/PetraTools/Templates"/>
  <ExecDotNet program="${tool-generateORM}" commandline="-do:cachedtables ${CachedTableParameters} -cachedef:${dir.root}/csharp/ICT/Petra/Definitions/CacheableTablesAndLists.yaml"/>
</target> 


<target name="generateGlue" depends="" description="Generate the glue between client and server, ie. interfaces and instantiators">
  <loadtasks assembly="${Ict.Tools.NAntTasks.DLL}" unless="${task::exists('ExecDotNet')}"/> 
  <ExecDotNet program="${dir.bin}/GenerateSharedCode.exe" commandline="-ymlfile:${dir.root}/csharp/ICT/Petra/Definitions/NamespaceHierarchy.yml -outputdir:${dir.root}/csharp/ICT/Petra -TemplateDir:${dir.root}/csharp/ICT/PetraTools/Templates"/>
</target>


<!-- Add the database as is add properties for compat -->
<property name="DBMS.Type" value="sqlite" overwrite="false" />
<property name="DBMS.DBName" value="openpetra" overwrite="false" />
<property name="DBMS.Password" value="petra" overwrite="false" /> 
<property name="DBDoc.Output.dir" value="${dir.delivery}/dbdoc" overwrite="false" />
<!-- 
<if test="" >
  <property name="Dia.exe" value="dia.exe" overwrite="true"/> 
  <property name="PostgreSQL.exe" value="${sys.env.ProgramFiles}/PostgreSQL/9.0/bin/psql.exe" overwrite="false" />
  <property name="MySQL.exe" value="${sys.env.ProgramFiles}\mysql\mysql server 5.1/bin/mysql.exe" overwrite="false" />
</if>
-->
  <property name="PostgreSQL.exe" value="psql" overwrite="true"/>
  <property name="MySQL.exe" value="mysql" overwrite="true"/>
    
    <property name="PostgreSQL.exe" value="/Library/PostgreSQL/8.3/bin/psql" overwrite="true"/> 
        
<!-- Add the database as is add properties for compat, which will be removed -->
<property name="OpenPetraRoot.dir" value="${dir.root}" overwrite="true" />
<property name="PetraRelease" value="0300" overwrite="false" />
<property name="SQLitedb.file" value="${dir.bin}/setup/petra${PetraRelease}/petra.db" overwrite="false" />
<property name="PetraToolsExe.dir" value="${dir.bin}" overwrite="true" />
<property name="DBDoc.Output.dir" value="${dir.delivery}/dbdoc" overwrite="false" />
<property name="ThirdParty.dir" value="${dir.3rdParty}" overwrite="false" />


<target name="init" />
  
<include buildfile="../../OpenPetra.build.database.tasks" />

</project>