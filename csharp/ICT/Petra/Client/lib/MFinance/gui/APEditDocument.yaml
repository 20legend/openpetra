RootNode:
    BaseYaml: ../../../CommonForms/PetraEditForm.yaml
    FormTitle: AP Document Edit
    ClassName: TFrmAccountsPayableEditDocument
    Namespace: Ict.Petra.Client.MFinance.Gui.AccountsPayable
    MasterTable: AApDocument
    DetailTable: AApDocumentDetail
    DatasetType: Ict.Petra.Shared.MFinance.AP.Data.AccountsPayableTDS
    FormType: edit
    HasManualCodeInOtherFile: true
    WindowWidth: 660
    WindowHeight: 500
    Actions:
        cndDiscountEnabled: {InitialValue=false}
    Controls:
        pnlContent:
            Controls: [pnlSupplierInfo, grpDocumentInfo, grpDetails]
            Dock: Fill
        pnlSupplierInfo:
            Controls: [txtSupplierName, txtSupplierCurrency]
            ControlsOrientation: horizontal
            Dock:Top
        txtSupplierName: {Label=Current Supplier, ReadOnly=true, PartnerShortNameLookup=AApDocument.PartnerKey}
        txtSupplierCurrency: {Label=Currency, ReadOnly=true, DataField=AApSupplier.CurrencyCode}
        grpDocumentInfo:
            Label: Document Information
            Controls: 
                Row0: [txtDocumentCode, cmbDocumentType]
                Row1: [txtReference]
                Row2: [dtpDateIssued, dtpDateDue, nudCreditTerms]
                Row3: [nudDiscountDays, txtDiscountPercentage]
                Row4: [txtTotalAmount, txtExchangeRateToBase]
            Dock: Top
        txtDocumentCode: {Label=Invoice &Number}
        cmbDocumentType:
            OptionalValues: [=Invoice, Credit Note]
            Label: T&ype
            DataField: CreditNoteFlag
        txtReference: {Label=&Reference, ColSpan=2}
        dtpDateIssued: {Label=&Date Issued, OnChange=UpdateCreditTerms}
        nudCreditTerms:
            Label: Credit &Terms
            Width: 50
            OnChange: UpdateCreditTerms
        dtpDateDue:
            Label: Date D&ue
            Tooltip: Credit Terms is the number of days between date issued and due date
            OnChange: UpdateCreditTerms
        nudDiscountDays: {Label=Discount &Days, PositiveValueActivates=cndDiscountEnabled}
        txtDiscountPercentage: {Label=Discount &Value (%), Enabled=cndDiscountEnabled}
        txtTotalAmount:
            Label: &Amount
        txtExchangeRateToBase:
            Label: E&xchange Rate
            # TODO: default value from daily exchange rate? update daily exchange rate?
        grpDetails:
            Label: Details
            Dock: Fill
            Controls: [grdDetails, pnlDetails]
        grdDetails:
            Dock: Fill
            DetailTable: true
            Columns: [AApDocumentDetail.Amount, AApDocumentDetail.ItemRef, AApDocumentDetail.Narrative]
        pnlDetails:
            Dock: Bottom
            Controls:
                Row0: [txtDetailNarrative, btnAddDetail]
                Row1: [txtDetailItemRef, btnRemoveDetail]
                Row2: [txtDetailAmount, cmbDetailCostCentreCode, btnAnalysisAttributes]
                Row3: [txtDetailBaseAmount, cmbDetailAccountCode, btnApproveDetail]
                Row4: [dtpDetailApprovalDate, btnUseTaxAccountCostCentre]
        txtDetailNarrative:
            ColSpan: 2
            Width: 350
            Label: Narrati&ve
        txtDetailItemRef:
            ColSpan: 2
            Width: 350
            Label: Detail &Ref
        txtDetailAmount:
            Label: A&mount
        txtDetailBaseAmount:
            Label: Base
            Enabled: false
            #TODO: calculate using exchange rate from document
        dtpDetailApprovalDate:
            Label: Approved On
            Enabled: false
        cmbDetailCostCentreCode:
            Label: C&ost Centre
        cmbDetailAccountCode:
            Label: Accou&nt
        btnUseTaxAccountCostCentre:
            Align: Right
            Label: Use Ta&x Acct+CC
            #TODO
        btnAddDetail:
            Label: Add De&tail
            Align: Right
            Width: 100
            Action: actNewDetail
        btnRemoveDetail:
            Label: &Remove Detail
            Align: Right
            Width: 100
            Action: actRemoveDetail
        btnAnalysisAttributes:
            Label: Analysis Attri&b.
            Align: Right
            Width: 100
        btnApproveDetail:
            Label: A&pprove Detail
            Align: Right
            Width: 150
            Enabled: false